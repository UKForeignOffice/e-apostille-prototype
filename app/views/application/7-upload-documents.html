{% extends "layout.html" %}

{% block pageTitle %}
  Upload your PDF files
{% endblock %}

{% block beforeContent %}
	<div class="flex-space-between">
		{{ govukBackLink({
			text: "Back",
			href: "/application/5a-how-to-complete-app"
		}) }}
		{% include "includes/my-account-nav.html" %}
	</div>
{% endblock %}


{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds-from-desktop">

	  {% if (data.errors) and (data.errors.length > 0) or (data.infectedFile) %}
		<div class="govuk-error-summary" aria-labelledby="error-summary-title" role="alert" tabindex="-1" data-module="govuk-error-summary">
			<h2 class="govuk-error-summary__title" id="error-summary-title">
				There is a problem
			</h2>
			<div class="govuk-error-summary__body">
				<ul class="govuk-list govuk-error-summary__list">
					{% if (data.errors.length > 0) %}
						<li>
							<a href="#error-list">One or more files could not be uploaded</a>
						</li>
					 {% endif %}
					{% if (data.infectedFile) %}
						<li>
							<a href="#file-upload">
								The following file cannot be uploaded because it is infected (may contain a virus). You might be able to upload a
                                    different copy of this file:</a>
						</li>
						<li>infected_file.pdf</li>
					 {% endif %}
				</ul>
			</div>
		</div>
	  {% endif %}

	<section class="govuk-body">
		<h1 class="govuk-heading-xl">Upload your PDF files</h1>
    {{ govukInsetText({
        text: "Â£30 for each e-Apostille issued."
      }) }}

    {{ govukDetails({
      summaryText: "Legalising more than one document",
      html: '<p class="govuk-body">One e-Apostille can be issued per PDF.</p>
            <p class="govuk-body">PDFs that contain multiple documents must have a cover sheet from the notary or solicitor listing all documents.</p>
            <p class="govuk-body">Prepare and upload each document that requires its own e-Apostille certificate as a separate PDF file.</p>
            <p class="govuk-body">If you include multiple documents in the same PDF file you will get a single e-Apostille that applies to, and must be shared together with, all of the documents in that PDF.</p>'
    }) }}
	</section>

  <h2 class="govuk-heading-m">Upload PDFs</h2>
	<form id="delete-file" action="/application/delete-file" method="post"></form>
	<form id="upload-files" action="/application/7-upload-documents/form-handler" method="post"></form>

	<div class="govuk-form-group">
		<fieldset class="govuk-fieldset" aria-describedby="changed-name-hint">
		<label class="govuk-label" for="file-upload-input">
				Select PDFs
		</label>
			<div class="flex flex--v-center">
				<input form="upload-files" class="govuk-file-upload" id="file-upload-input" name="documents" type="file" multiple accept="application/pdf">
			</div>
		</fieldset>
	</div>

	<input form="upload-files" id="file-upload" type="hidden" value="{{data.documents}}" name="existingDocs" />
	<button form="upload-files" id="file-upload-btn" class="govuk-button govuk-button--secondary" data-module="govuk-button">
		Upload
	</button>

	{% if (data.errors) and (data.errors.length > 0) %}
		<h3 class="govuk-heading-m" id="error-list">
			{% if (data.errors.length > 1)%}
				{{ data.errors.length }} files have errors
			{% else %}
				1 file had errors
			{% endif %}
		</h3>
		<section class="govuk-body multi-file-upload__list">
		{% if (data.errors.includes('LARGE_FILE_ERROR')) %}
			<div class="multi-file-upload__error-item">
				<p>eapp_test_pdf.pdf</p>
				<p class="govuk-error-message">
					The file is too big. Each file you upload must be a maximum of 200MB
				<p>
			</div>
		{% endif %}
		{% if (data.errors.includes('NOT_PDF_ERROR')) %}
			<div class="multi-file-upload__error-item">
				<p>not_pdf.pdf</p>
				<p class="govuk-error-message">
					The file is in the wrong file type. Only PDF files are allowed.
				<p>
			</div>
		{% endif %}
		</section>
	{% endif %}

	{% if (data.documents[0] !== '') and (data.documents.length > 0) %}
		<h3 class="govuk-heading-m">
			{% if (data.noOfDocs > 1)%}
				{{ data.noOfDocs}} files were uploaded
			{% else %}
				1 file was uploaded
			{% endif %}
		</h3>
		<ul class="govuk-body uploaded-files">
			{% for document in data.documents %}
				<li>
					{{document}}
					<button form="delete-file" name="document" value="{{document}}" class="govuk-button govuk-button--secondary" data-module="govuk-button">
						Delete
					</button>
				</li>
			{% endfor %}
		</ul>

		{{ govukButton({
         href: "/application/8-user-reference",
         text: "Continue"
		}) }}
	{% endif %}

  <p class="govuk-body">
    <a class="govuk-link" href="/application/7-upload-documents-exit">I cannot upload my PDFs</a>
  </p>

	</div>
</div>


{% endblock %}
